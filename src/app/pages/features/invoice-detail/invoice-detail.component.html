<nb-card>
  <nb-card-header class="custom-header d-flex align-items-center">
    <nb-icon icon="file-text-outline"></nb-icon>
    <span class="ms-2 fw-bold">Invoice Detail</span>
  </nb-card-header>

  <nb-card-body>
    <div class="row d-flex justify-content-center">
      <div class="col-md-4">
        <label for="clientSelect" class="fw-bold">Select</label>
        <select id="clientSelect" class="form-control" [(ngModel)]="selectedType" (ngModelChange)="onClientSelect()">
          <option value="All">All</option>
          <option value="PAID">Paid</option>
          <option value="UNPAID">Unpaid</option>
          <option value="DELETED">Deleted</option>
          <option value="clientId">By Client ID</option>
        </select>
      </div>
    </div>

    <div class="text-center mt-4">
      <button class="btn btn-success px-4 py-2 fw-bold" (click)="toggleDetails()" [disabled]="!selectedType">
        <i class="fas fa-file-invoice"></i> Get All Invoices
      </button>
    </div>

    <div *ngIf="showDetails" class="mt-4">
      <div class="table-responsive table-container" style="max-height: 400px; overflow-y: auto;">
        <table class="invoice-table table table-striped table-bordered">
          <thead class="thead-dark">
            <tr>
              <th>#</th>
              <th>Invoice ID</th>
              <th>Creation Date</th>
              <th>Start Date</th>
              <th>End Date</th>
              <th>Status</th>
              <th>Payable Amount</th>
              <th>Tax Amount</th>
              <th>Total Amount</th>
              <th>Actions</th>
            </tr>
          </thead>
          <tbody>
            <tr *ngFor="let invoice of invoiceData?.content; let i = index">
              <td>{{ (invoiceData.number * invoiceData.size) + i + 1 }}</td>
              <td>{{ invoice.id }}</td>
              <td>{{ invoice.creationDate }}</td>
              <td>{{ invoice.startDate }}</td>
              <td>{{ invoice.endDate }}</td>
              <td>
                <span [ngClass]="{ 'text-success': invoice.invoiceStatus === 'PAID', 'text-danger': invoice.invoiceStatus === 'UNPAID' }">
                  {{ invoice.invoiceStatus }}
                </span>
              </td>
              <td>{{ invoice.payableAmount }}</td>
              <td>{{ invoice.taxAmount || 'N/A' }}</td>
              <td>{{ invoice.totalAmountWithTax || 'N/A' }}</td>
              <td>
                <button class="btn btn-sm btn-primary" (click)="editInvoice(invoice)">
                  <nb-icon icon="edit-outline"></nb-icon>
                </button>
                <button class="btn btn-sm btn-info ml-2 mr-2" (click)="viewInvoice(invoice)">
                  <nb-icon icon="eye-outline"></nb-icon>
                </button>
                <button class="btn btn-sm btn-warning" (click)="printInvoice(invoice)">
                  <nb-icon icon="printer-outline"></nb-icon>
                </button>
              </td>
            </tr>
          </tbody>
        </table>
      </div>

      <!-- Pagination -->
      <pagination-controls
      (pageChange)="changePage($event)"
      [totalItems]="invoiceData?.totalElements"
      [itemsPerPage]="pageSize"
      previousLabel="Prev"
      nextLabel="Next"
    ></pagination-controls>
    
    </div>

    <div class="mt-4 text-center" *ngIf="invoiceData?.content?.length === 0">
      <p>No Record Found</p>
    </div>
  </nb-card-body>
</nb-card>
